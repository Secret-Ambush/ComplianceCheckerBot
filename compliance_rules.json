[    
    {
        "rule_id": "DOC_MATCH_001",
        "description": "Invoice PO number must match PO document PO number",
        "applies_to": ["invoice", "purchase_order"],
        "fields": {
            "invoice.fields.po_number": "purchase_order.fields.po_number"
        },
        "check_type": "equality",
        "on_fail": "PO number mismatch between Invoice and PO"
    },
    {
        "rule_id": "DOC_MATCH_002",
        "description": "GRN reference must match invoice delivery reference",
        "applies_to": ["invoice", "grn"],
        "fields": {
            "invoice.fields.delivery_ref": "grn.fields.ref_number"
        },
        "check_type": "equality",
        "on_fail": "Delivery reference mismatch between GRN and Invoice"
    },
    {
        "rule_id": "LOGIC_001",
        "description": "Invoice quantity should not exceed PO quantity",
        "applies_to": ["invoice", "purchase_order"],
        "fields": {
            "invoice.fields.quantity": "purchase_order.fields.quantity"
        },
        "check_type": "less_than_or_equal",
        "on_fail": "Invoiced quantity exceeds PO quantity"
    },
    {
        "rule_id": "LOGIC_002",
        "description": "Total amount should equal quantity * unit price",
        "applies_to": ["invoice"],
        "fields": {
            "invoice.fields.total_amount": [
                "invoice.fields.quantity",
                "invoice.fields.unit_price"
            ]
        },
        "check_type": "expression",
        "expression": "quantity * unit_price",
        "on_fail": "Total amount doesn't match calculated amount"
    },
    {
        "rule_id": "CROSS_001",
        "description": "Invoice date should be after PO date",
        "applies_to": ["invoice", "purchase_order"],
        "fields": {
            "invoice.fields.invoice_date": "purchase_order.fields.po_date"
        },
        "check_type": "date_after",
        "on_fail": "Invoice is dated before the PO"
    },
    {
        "rule_id": "CROSS_002",
        "description": "GRN date must be before invoice date",
        "applies_to": ["grn", "invoice"],
        "fields": {
            "grn.fields.date": "invoice.fields.invoice_date"
        },
        "check_type": "date_before",
        "on_fail": "GRN is dated after the invoice"
    },
    {
        "rule_id": "LOOKUP_001",
        "description": "Invoice vendor must exist in approved vendor list",
        "applies_to": ["invoice"],
        "fields": {
            "invoice.fields.vendor_id": "reference.approved_vendors"
        },
        "check_type": "lookup",
        "on_fail": "Vendor is not on the approved vendor list"
    },
    {
        "rule_id": "LOOKUP_002",
        "description": "Invoice currency must be in allowed currencies list",
        "applies_to": ["invoice"],
        "fields": {
            "invoice.fields.currency": "reference.allowed_currencies"
        },
        "check_type": "lookup",
        "on_fail": "Currency not allowed for invoicing"
    },
    {
        "rule_id": "INVOICE_TOTAL_THRESHOLD",
        "description": "Total invoice amount must not exceed 10,000 AED",
        "applies_to": ["invoice"],
        "fields": {
            "invoice.fields.total_amount": "10000"
        },
        "check_type": "less_than_or_equal",
        "on_fail": "Total invoice amount exceeds the permitted threshold"
    },
    {
        "rule_id": "TABLE_SUM_CHECK_001",
        "description": "Sum of line item totals must equal invoice total",
        "applies_to": ["invoice"],
        "fields": {
            "invoice.fields.total_amount": "invoice.tables_structured[*].total"
        },
        "check_type": "tolerance",
        "parameters": {
            "tolerance_percent": 1
        },
        "on_fail": "Sum of line item totals does not match invoice total"
    }    
]